<!DOCTYPE html>

<html lang="python" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Manager Documentation &#8212; OrthoEvolution 1.0.0b2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=3e4b6f43"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Orthologs Documentation" href="../orthologs/orthologsreadme.html" />
    <link rel="prev" title="Cookies Documentation" href="../cookies/cookiesreadme.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="manager-documentation">
<h1>Manager Documentation<a class="headerlink" href="#manager-documentation" title="Link to this heading">¶</a></h1>
<p>The classes and functions in this module have been designed to help
manage existing and new projects using the Cookies module as well as the
different utilities found in the Tools module.</p>
<section id="why-a-manager">
<h2>Why a manager?<a class="headerlink" href="#why-a-manager" title="Link to this heading">¶</a></h2>
<p>This module is intended to mesh with a Flask user interface. While the
Flask server/client interface is not currently set up, we are developing
the package so that it will be easier to implement.</p>
<ul class="simple">
<li><p>Whenever a new website is made the RepoManagement and WebManagement
classes are used.</p>
<ul>
<li><p>Whenever a new user is created in the Flask webpage, the
UserManagement class is used.</p></li>
<li><p>Whenever an existing user creates a new project, the
ProjectManagement class is used.</p></li>
</ul>
</li>
</ul>
<p>This module does not have to be used to create a Flask webpage. The full
repository can be used for higher level organization, or standalone
projects can be made using the ProjectManagements <code class="docutils literal notranslate"><span class="pre">_basic_project_</span></code>
flag.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h2>
<p>Using DatabaseDispatcher to set up the proper databases using a <code class="docutils literal notranslate"><span class="pre">YAML</span></code>
config file. This example is based on <code class="docutils literal notranslate"><span class="pre">db_mana_test.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">OrthoEvol.Manager.management</span> <span class="kn">import</span> <span class="n">ProjectManagement</span>
<span class="kn">from</span> <span class="nn">OrthoEvol.Manager.database_dispatcher</span> <span class="kn">import</span> <span class="n">DatabaseDispatcher</span>
<span class="kn">from</span> <span class="nn">OrthoEvol.Manager.config</span> <span class="kn">import</span> <span class="n">yml</span>
<span class="kn">from</span> <span class="nn">pkg_resources</span> <span class="kn">import</span> <span class="n">resource_filename</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">d</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Define job name</span>
<span class="n">job_name</span> <span class="o">=</span> <span class="s2">&quot;jobname&quot;</span>

<span class="c1"># Function to load configuration from YAML file</span>
<span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">resource_filename</span><span class="p">(</span><span class="n">yml</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>

<span class="c1"># Load project management configuration</span>
<span class="n">pm_config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s2">&quot;initialize_new.yml&quot;</span><span class="p">)</span>
<span class="n">project_manager</span> <span class="o">=</span> <span class="n">ProjectManagement</span><span class="p">(</span><span class="o">**</span><span class="n">pm_config</span><span class="p">[</span><span class="s2">&quot;Management_config&quot;</span><span class="p">])</span>

<span class="c1"># Load and update database management configuration</span>
<span class="n">db_config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s2">&quot;databases.yml&quot;</span><span class="p">)</span>
<span class="n">db_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pm_config</span><span class="p">)</span>

<span class="c1"># Configure NCBI RefSeq release settings</span>
<span class="n">ncbi_config</span> <span class="o">=</span> <span class="n">db_config</span><span class="p">[</span><span class="s1">&#39;Database_config&#39;</span><span class="p">][</span><span class="s1">&#39;Full&#39;</span><span class="p">][</span><span class="s1">&#39;NCBI&#39;</span><span class="p">][</span><span class="s1">&#39;NCBI_refseq_release&#39;</span><span class="p">]</span>
<span class="n">ncbi_config</span><span class="p">[</span><span class="s1">&#39;upload_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">ncbi_config</span><span class="p">[</span><span class="s1">&#39;pbs_dict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">(),</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;This is a default pbs job.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%a</span><span class="s1"> %b </span><span class="si">%d</span><span class="s1"> %I:%M:%S %p %Y&#39;</span><span class="p">),</span>
    <span class="s1">&#39;proj_name&#39;</span><span class="p">:</span> <span class="s1">&#39;OrthoEvol&#39;</span><span class="p">,</span>
    <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;memgb&#39;</span><span class="p">:</span> <span class="s1">&#39;6gb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cput&#39;</span><span class="p">:</span> <span class="s1">&#39;72:00:00&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wt&#39;</span><span class="p">:</span> <span class="s1">&#39;2000:00:00&#39;</span><span class="p">,</span>
    <span class="s1">&#39;job_name&#39;</span><span class="p">:</span> <span class="n">job_name</span><span class="p">,</span>
    <span class="s1">&#39;outfile&#39;</span><span class="p">:</span> <span class="n">job_name</span> <span class="o">+</span> <span class="s1">&#39;.o&#39;</span><span class="p">,</span>
    <span class="s1">&#39;errfile&#39;</span><span class="p">:</span> <span class="n">job_name</span> <span class="o">+</span> <span class="s1">&#39;.e&#39;</span><span class="p">,</span>
    <span class="s1">&#39;script&#39;</span><span class="p">:</span> <span class="n">job_name</span><span class="p">,</span>
    <span class="s1">&#39;log_name&#39;</span><span class="p">:</span> <span class="n">job_name</span><span class="p">,</span>
    <span class="s1">&#39;pbsworkdir&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
    <span class="s1">&#39;cmd&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;python3.6 </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="w"> </span><span class="n">job_name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;.py&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;n/a&#39;</span>
<span class="p">}</span>

<span class="c1"># Save the updated configuration to a YAML file</span>
<span class="n">config_file_path</span> <span class="o">=</span> <span class="n">project_manager</span><span class="o">.</span><span class="n">user_log</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;upload_config.yml&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">config_file</span><span class="p">:</span>
    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">db_config</span><span class="p">,</span> <span class="n">config_file</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Initialize database dispatcher and execute dispatch functions</span>
<span class="n">db_dispatcher</span> <span class="o">=</span> <span class="n">DatabaseDispatcher</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">,</span> <span class="n">project_manager</span><span class="p">)</span>
<span class="n">db_dispatcher</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">db_dispatcher</span><span class="o">.</span><span class="n">strategies</span><span class="p">,</span> <span class="n">db_dispatcher</span><span class="o">.</span><span class="n">dispatcher</span><span class="p">,</span> <span class="n">db_dispatcher</span><span class="o">.</span><span class="n">configuration</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h2>
<p>Please view our <a class="reference external" href="https://github.com/datasnakes/OrthoEvolution/tree/master/OrthoEvol/Manager/BioSQL/README.md">BioSQL
documentation</a>
and view some of the static/config related
<a class="reference external" href="https://github.com/datasnakes/OrthoEvolution/tree/master/OrthoEvol/Manager/config/">files</a>.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">OrthoEvolution</a></h1>



<p class="blurb">An easy to use and comprehensive python package which aids in the analysis and visualization of comparative evolutionary genetics</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Datasnakes&repo=OrthoEvolution&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Manager Documentation</a><ul>
<li><a class="reference internal" href="#why-a-manager">Why a manager?</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
</ul>

  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2017, Shaurita Hutchins & Robert Gilmore.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/manager/managerreadme.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/Datasnakes/OrthoEvolution" class="github">
        <img src="../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>